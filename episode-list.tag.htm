<xsl>
	<xsl:template match='*'>
		<img src='{//channel/image/url}' />
		<h1>
			<xsl:value-of select='//channel/title' />
		</h1>
		<p>
			<xsl:value-of select='//channel/description' />
		</p>

		<div id='player'>
			<audio controls="controls">
				<!-- <source src="horse.ogg" type="audio/ogg"> -->
				<!-- <source src="https://open.live.bbc.co.uk/mediaselector/6/redir/version/2.0/mediaset/audio-nondrm-download-low/proto/https/vpid/p0902c0s.mp3" type="audio/mpeg"/> -->
				<source src="" type="audio/mpeg" />
				Your browser does not support the audio element.
			</audio>
		</div>

		<br />
		<xsl:for-each select='//item'>
			<card url='{*[starts-with(@url,"https:")]/@url}' on-tap='play'>
				<i>
					<xsl:value-of select='pubDate' />
				</i>
				<h3>

					<xsl:value-of select='title' />
				</h3>
				<p>
					<xsl:value-of select='description' />
				</p>
				<a>
					<xsl:value-of select='*[starts-with(@url,"https:")]/@url' />
				</a>
			</card>
		</xsl:for-each>
	</xsl:template>
</xsl>

<style>
	img {
		width: 100px;
	}

	a {
		color: gray;
		cursor: pointer;
	}

#player{
	position: fixed;
	bottom:0;
	background: #000;
	width: 50%;
	padding: 1rem;
}

	card {
		display: block;
		margin: 1rem;
		padding: 1rem;
		background: #333;
	}

	card:hover {
		background: #444;
		cursor: pointer;
	}
</style>

<script>
	class {
		async $onReady() {
			this.$data = await fetch(`https://podcasts.files.bbci.co.uk/p02nq0gn.rss`).then(x => x.text())
			console.log('data', this.$data)
		}
		play(node) {
			let url = node.getAttribute('url')
			console.log('play', url)
			let player = this.$view.Q('audio', 1);
			player.innerHTML = `<source src="${url}" type="audio/mpeg" />`;
			player.load()
			player.play();
			// let src = this.$view.Q('audio>source', 1);
			// console.log('src', src)
			// src.setAttribute('src', url)
			// this.$view.Q('audio', 1).play()
		}
	}
</script>